<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peringkas Cerdas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom spinner animation if Tailwind's spin is not sufficient or for more control */
        .spinner-custom {
            border-top-color: transparent;
            border-right-color: transparent; /* Ensuring only one segment is colored for a typical spinner look */
            border-bottom-color: transparent;
            /* Tailwind's animate-spin uses 'spin 1s linear infinite' */
        }
         @keyframes spin {
            to { transform: rotate(360deg); }
        }
        /* Ensure Tailwind's animate-spin is available or define it */
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <div class="container mx-auto max-w-3xl px-4 py-8 md:py-12">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">Peringkas Cerdas</h1>
            <p class="text-lg text-gray-600">Ringkas teks panjang menjadi poin-poin penting dengan mudah.</p>
        </header>

        <main class="bg-white p-6 md:p-8 rounded-2xl shadow-lg mb-8">
            <div class="mb-6">
                <label for="inputText" class="block mb-2 text-lg font-medium text-gray-700">Masukkan Teks Anda:</label>
                <textarea id="inputText" rows="10" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 resize-none" placeholder="Ketik atau tempel teks Anda di sini..."></textarea>
            </div>

            <div class="text-center mb-6">
                <button id="summarizeBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-150 ease-in-out">Ringkas Sekarang</button>
            </div>

            <div id="resultContainer" class="mt-8 pt-6 border-t border-gray-200" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-semibold">Hasil Ringkasan</h2>
                    <button id="copyBtn" class="bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">Salin Hasil</button>
                </div>
                <div id="summaryOutput" class="bg-gray-100 p-4 rounded-lg min-h-[100px] space-y-2">
                    <!-- Hasil ringkasan akan muncul di sini sebagai list -->
                </div>
            </div>

            <div id="loadingIndicator" class="text-center py-10" style="display: none;">
                <div class="spinner w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto spinner-custom"></div>
                <p class="mt-3 text-gray-600">Sedang memproses...</p>
            </div>

            <div id="errorMessage" class="bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded-lg mb-6 text-center" style="display: none;">
                <!-- Pesan error akan muncul di sini -->
            </div>
        </main>

        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p>&copy; 2024 Peringkas Cerdas. Dibuat oleh Jules.</p>
        </footer>
    </div>

    <script>
        const inputText = document.getElementById('inputText');
        const summarizeBtn = document.getElementById('summarizeBtn');
        const resultContainer = document.getElementById('resultContainer');
        const summaryOutput = document.getElementById('summaryOutput');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const errorMessage = document.getElementById('errorMessage');
        const copyBtn = document.getElementById('copyBtn');

        // Kunci API Google Gemini - HARUS DIISI OLEH PENGGUNA
        // Dapatkan kunci API Anda dari Google AI Studio: https://aistudio.google.com/app/apikey
        const apiKey = "";

        summarizeBtn.addEventListener('click', async () => {
            const textToSummarize = inputText.value.trim();

            if (!textToSummarize) {
                errorMessage.textContent = "Teks tidak boleh kosong.";
                errorMessage.style.display = 'block';
                resultContainer.style.display = 'none';
                return;
            }

            if (!apiKey) {
                errorMessage.textContent = "Kunci API belum diisi. Silakan isi kunci API di dalam kode JavaScript.";
                errorMessage.style.display = 'block';
                resultContainer.style.display = 'none';
                return;
            }

            // Kelola UI State (Mulai)
            errorMessage.style.display = 'none';
            resultContainer.style.display = 'none';
            loadingIndicator.style.display = 'block';
            summarizeBtn.disabled = true;
            summarizeBtn.classList.add('opacity-50', 'cursor-not-allowed');

            const prompt = `Buatkan 5 poin ringkasan utama (bullet points) dari teks berikut, dalam Bahasa Indonesia:\n\n"${textToSummarize}"`;
            // Menggunakan model gemini-1.5-flash-latest seperti yang diputuskan dalam rencana
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || `Error ${response.status}: Gagal menghubungi API.`);
                }

                const data = await response.json();

                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
                    const summaryText = data.candidates[0].content.parts[0].text;
                    summaryOutput.innerHTML = ''; // Bersihkan output sebelumnya

                    // Ubah markdown bullet points menjadi elemen <li> HTML
                    const bulletPoints = summaryText.split(/\r?\n/).filter(line => line.trim().startsWith('*') || line.trim().startsWith('-'));
                    if (bulletPoints.length > 0) {
                        const ul = document.createElement('ul');
                        ul.className = 'list-disc list-inside space-y-1'; // Tambahkan kelas Tailwind untuk styling list
                        bulletPoints.forEach(point => {
                            const li = document.createElement('li');
                            li.textContent = point.substring(point.indexOf(' ') + 1).trim(); // Hapus '*' atau '-' dan spasi
                            ul.appendChild(li);
                        });
                        summaryOutput.appendChild(ul);
                    } else {
                         // Jika tidak ada bullet points, tampilkan teks apa adanya
                        summaryOutput.textContent = summaryText;
                    }
                    resultContainer.style.display = 'block';
                } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                    // Handle kasus di mana prompt diblokir oleh API
                    console.error('Prompt diblokir:', data.promptFeedback);
                    let userMessage = `Ringkasan tidak dapat dibuat. Alasan: ${data.promptFeedback.blockReason}.`;
                    if (data.promptFeedback.safetyRatings) {
                        userMessage += " Detail: " + data.promptFeedback.safetyRatings.map(r => `${r.category} - ${r.probability}`).join(", ");
                    }
                    errorMessage.textContent = userMessage;
                    errorMessage.style.display = 'block';
                }
                else {
                    // Struktur respons tidak sesuai harapan
                    console.error('Struktur respons API tidak valid:', data);
                    errorMessage.textContent = "Gagal memproses ringkasan dari respons API. Struktur data tidak dikenali.";
                    errorMessage.style.display = 'block';
                }

            } catch (error) {
                console.error('Error fetching summary:', error);
                errorMessage.textContent = `Gagal mendapatkan ringkasan: ${error.message}. Pastikan kunci API valid dan coba lagi.`;
                errorMessage.style.display = 'block';
            } finally {
                // Finalisasi UI
                loadingIndicator.style.display = 'none';
                summarizeBtn.disabled = false;
                summarizeBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        });

        copyBtn.addEventListener('click', () => {
            const textToCopy = summaryOutput.innerText;
            if (!textToCopy) return;

            // Buat textarea sementara untuk menyalin teks
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = textToCopy;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            tempTextArea.setSelectionRange(0, 99999); // Untuk perangkat mobile

            try {
                document.execCommand('copy');
                originalCopyBtnText = copyBtn.textContent;
                copyBtn.textContent = 'Tersalin!';
                setTimeout(() => {
                    copyBtn.textContent = originalCopyBtnText;
                }, 2500);
            } catch (err) {
                console.error('Gagal menyalin teks: ', err);
                // Mungkin tampilkan pesan error kecil di dekat tombol salin jika diperlukan
                alert("Gagal menyalin teks ke clipboard.");
            }
            document.body.removeChild(tempTextArea);
        });
    </script>
</body>
</html>
